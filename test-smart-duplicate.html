<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>æ™ºèƒ½é‡å¤æ¡ç›®åˆ¤æ–­æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }

        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .item {
            border: 1px solid #ddd;
            padding: 10px;
            margin: 5px;
            background: #f0f0f0;
            cursor: grab;
            display: inline-block;
        }

        .dropzone {
            border: 2px dashed #ccc;
            padding: 10px;
            margin: 10px 0;
            min-height: 50px;
        }

        .dropzone.over {
            background: #e8f4fd;
        }

        .correct {
            background-color: #27ae60 !important;
            border-color: #27ae60 !important;
            color: white;
        }

        .incorrect {
            background-color: #e74c3c !important;
            border-color: #e74c3c !important;
            color: white;
        }

        .info {
            background: #e3f2fd;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>

<body>
    <h1>æ™ºèƒ½é‡å¤æ¡ç›®åˆ¤æ–­æµ‹è¯•</h1>

    <div class="test-section">
        <h2>æµ‹è¯•1: æœ‰é‡å¤æ¡ç›®çš„å¡ç»„</h2>
        <div class="info">
            <p><strong>æ•°æ®ï¼š</strong>Aåˆ†ç»„ï¼š1,2,3 Båˆ†ç»„ï¼š2,3,4</p>
            <p><strong>é¢„æœŸè¡Œä¸ºï¼š</strong>æ¡ç›®æ‹–æ‹½åä¸æ¶ˆå¤±ï¼Œå¯ä»¥é‡å¤ä½¿ç”¨</p>
            <p><strong>å±•ç¤ºï¼š</strong>1,2,3,4ï¼ˆå–åˆé›†ï¼‰</p>
        </div>
        <button onclick="testWithDuplicates()">æµ‹è¯•æœ‰é‡å¤æ¡ç›®çš„å¡ç»„</button>
        <div id="test1-result"></div>
    </div>

    <div class="test-section">
        <h2>æµ‹è¯•2: æ— é‡å¤æ¡ç›®çš„å¡ç»„</h2>
        <div class="info">
            <p><strong>æ•°æ®ï¼š</strong>Aåˆ†ç»„ï¼š1,2,3 Båˆ†ç»„ï¼š4,5,6</p>
            <p><strong>é¢„æœŸè¡Œä¸ºï¼š</strong>æ¡ç›®æ‹–æ‹½åæ¶ˆå¤±ï¼Œä¸èƒ½é‡å¤ä½¿ç”¨</p>
            <p><strong>å±•ç¤ºï¼š</strong>1,2,3,4,5,6</p>
        </div>
        <button onclick="testWithoutDuplicates()">æµ‹è¯•æ— é‡å¤æ¡ç›®çš„å¡ç»„</button>
        <div id="test2-result"></div>
    </div>

    <div class="test-section">
        <h2>æ‹–æ‹½æµ‹è¯•åŒºåŸŸ</h2>
        <div id="itemPool"></div>
        <div class="dropzone" data-group="A">
            <strong>Aåˆ†ç»„ï¼š</strong>
        </div>
        <div class="dropzone" data-group="B">
            <strong>Båˆ†ç»„ï¼š</strong>
        </div>
        <button onclick="checkAnswers()">æ£€æŸ¥ç­”æ¡ˆ</button>
        <button id="restartBtn" style="display: none;">å†æ¥ä¸€é</button>
        <div id="result"></div>
    </div>

    <script>
        let currentTestData = null;
        let hasDuplicateItems = false;

        // æ˜¾ç¤ºé‡å¤æ¡ç›®æç¤ºä¿¡æ¯
        function showDuplicateHint() {
            const testSection = document.querySelector('.test-section:last-child');
            if (!testSection) return;

            // æ£€æŸ¥æ˜¯å¦å·²ç»æœ‰æç¤ºä¿¡æ¯
            const existingHint = testSection.querySelector('.duplicate-hint');
            if (existingHint) return;

            const hintDiv = document.createElement("div");
            hintDiv.className = "duplicate-hint";
            hintDiv.innerHTML = `
                <div style="
                    background: #e3f2fd;
                    border: 1px solid #2196f3;
                    border-radius: 8px;
                    padding: 12px 16px;
                    margin-bottom: 16px;
                    color: #1976d2;
                    font-size: 14px;
                    line-height: 1.5;
                ">
                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                        <span style="
                            background: #2196f3;
                            color: white;
                            border-radius: 50%;
                            width: 20px;
                            height: 20px;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            font-size: 12px;
                            margin-right: 8px;
                        ">ğŸ’¡</span>
                        <strong>æç¤º</strong>
                    </div>
                    <p style="margin: 0;">è¯¥å¡ç»„å­˜åœ¨å¤šä¸ªåˆ†ç±»ä¸‹åŒ…å«åŒä¸€ä¸ªæ¡ç›®ï¼Œä¸ºäº†å¸®åŠ©æ›´å¥½åœ°è®°å¿†ï¼Œæ‰€æœ‰æ¡ç›®å¯ä»¥å¤šæ¬¡é‡å¤æ‹–æ‹½ä½œç­”ã€‚</p>
                </div>
            `;

            // æ’å…¥åˆ°æµ‹è¯•åŒºåŸŸçš„æœ€å‰é¢
            testSection.insertBefore(hintDiv, testSection.firstChild);
        }

        // æµ‹è¯•1: æœ‰é‡å¤æ¡ç›®çš„å¡ç»„
        function testWithDuplicates() {
            currentTestData = {
                'A': ['1', '2', '3'],
                'B': ['2', '3', '4']
            };
            hasDuplicateItems = true;

            // å±•ç¤ºå”¯ä¸€æ¡ç›®ï¼ˆå–åˆé›†ï¼‰
            const uniqueItems = ['1', '2', '3', '4'];
            renderItems(uniqueItems);

            // æ˜¾ç¤ºæç¤ºä¿¡æ¯
            showDuplicateHint();

            document.getElementById('test1-result').innerHTML = `
                <div class="info">
                    <p>âœ… æ£€æµ‹åˆ°é‡å¤æ¡ç›®ï¼Œå¯ç”¨å¯é‡å¤ä½¿ç”¨åŠŸèƒ½</p>
                    <p>å±•ç¤ºæ¡ç›®ï¼š${uniqueItems.join(', ')}</p>
                    <p>å¯ä»¥å¤šæ¬¡æ‹–æ‹½2å’Œ3åˆ°ä¸åŒåˆ†ç»„ï¼Œä½†åŒä¸€åˆ†ç»„å†…ä¸èƒ½é‡å¤æ·»åŠ </p>
                </div>
            `;
        }

        // æµ‹è¯•2: æ— é‡å¤æ¡ç›®çš„å¡ç»„
        function testWithoutDuplicates() {
            currentTestData = {
                'A': ['1', '2', '3'],
                'B': ['4', '5', '6']
            };
            hasDuplicateItems = false;

            // å±•ç¤ºæ‰€æœ‰æ¡ç›®
            const allItems = ['1', '2', '3', '4', '5', '6'];
            renderItems(allItems);

            document.getElementById('test2-result').innerHTML = `
                <div class="info">
                    <p>âœ… æœªæ£€æµ‹åˆ°é‡å¤æ¡ç›®ï¼Œä½¿ç”¨ä¼ ç»Ÿæ‹–æ‹½é€»è¾‘</p>
                    <p>å±•ç¤ºæ¡ç›®ï¼š${allItems.join(', ')}</p>
                    <p>æ¡ç›®æ‹–æ‹½åæ¶ˆå¤±ï¼Œä¸èƒ½é‡å¤ä½¿ç”¨</p>
                </div>
            `;
        }

        // æ¸²æŸ“æ¡ç›®
        function renderItems(items) {
            const itemPool = document.getElementById('itemPool');
            itemPool.innerHTML = '';

            items.forEach((item, index) => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'item';
                itemDiv.textContent = item;
                itemDiv.dataset.text = item;
                itemDiv.draggable = true;

                // ä¸ºæ¯ä¸ªitemæ·»åŠ å”¯ä¸€æ ‡è¯†ç¬¦
                const dragId = Date.now() + '_' + index + '_' + Math.random().toString(36).substr(2, 9);
                itemDiv.dataset.dragId = dragId;

                itemDiv.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', JSON.stringify({
                        text: item,
                        group: null
                    }));
                    e.dataTransfer.setData('draggedItem', dragId);
                });

                itemPool.appendChild(itemDiv);
            });
        }

        // è®¾ç½®æ‹–æ‹½åŒºåŸŸ
        document.addEventListener('DOMContentLoaded', function () {
            const dropzones = document.querySelectorAll('.dropzone');

            dropzones.forEach(dropzone => {
                dropzone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    dropzone.classList.add('over');
                });

                dropzone.addEventListener('dragleave', () => {
                    dropzone.classList.remove('over');
                });

                dropzone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    dropzone.classList.remove('over');

                    const data = JSON.parse(e.dataTransfer.getData('text/plain'));

                    // æ ¹æ®æ˜¯å¦æœ‰é‡å¤æ¡ç›®å†³å®šæ˜¯å¦ç§»é™¤æ‹–æ‹½çš„æ¡ç›®
                    if (hasDuplicateItems) {
                        // æœ‰é‡å¤æ¡ç›®ï¼šæ£€æŸ¥å½“å‰åˆ†ç»„æ˜¯å¦å·²ç»æœ‰è¿™ä¸ªæ¡ç›®
                        const existingItems = dropzone.querySelectorAll('.item');
                        const alreadyExists = Array.from(existingItems).some(item =>
                            item.textContent === data.text
                        );

                        if (!alreadyExists) {
                            // å½“å‰åˆ†ç»„è¿˜æ²¡æœ‰è¿™ä¸ªæ¡ç›®ï¼Œå¯ä»¥æ·»åŠ 
                            const itemDiv = document.createElement('div');
                            itemDiv.className = 'item';
                            itemDiv.textContent = data.text;
                            itemDiv.dataset.text = data.text;
                            dropzone.appendChild(itemDiv);
                        } else {
                            // å½“å‰åˆ†ç»„å·²ç»æœ‰è¿™ä¸ªæ¡ç›®ï¼Œä¸å…è®¸é‡å¤æ·»åŠ 
                            alert(`"${data.text}" å·²ç»åœ¨æ­¤åˆ†ç»„ä¸­ï¼Œä¸èƒ½é‡å¤æ·»åŠ `);
                        }
                    } else {
                        // æ— é‡å¤æ¡ç›®ï¼šä½¿ç”¨åŸæ¥çš„é€»è¾‘ï¼Œæ‹–æ‹½åæ¶ˆå¤±
                        const draggedItem = e.dataTransfer.getData('draggedItem');
                        if (draggedItem) {
                            const itemToRemove = document.querySelector(`[data-drag-id="${draggedItem}"]`);
                            if (itemToRemove) {
                                itemToRemove.remove();
                            }
                        }
                        const itemDiv = document.createElement('div');
                        itemDiv.className = 'item';
                        itemDiv.textContent = data.text;
                        itemDiv.dataset.text = data.text;
                        dropzone.appendChild(itemDiv);
                    }
                });
            });
        });

        // æ£€æŸ¥ç­”æ¡ˆ
        function checkAnswers() {
            if (!currentTestData) {
                alert('è¯·å…ˆé€‰æ‹©æµ‹è¯•æ•°æ®');
                return;
            }

            const result = document.getElementById('result');
            let resultHtml = '<h3>æ£€æŸ¥ç»“æœï¼š</h3>';

            // é‡ç½®æ‰€æœ‰itemçš„é¢œè‰²
            document.querySelectorAll('.item').forEach(item => {
                item.classList.remove('correct', 'incorrect');
            });

            Object.keys(currentTestData).forEach(groupName => {
                const groupItems = document.querySelectorAll(`[data-group="${groupName}"] .item`);
                let correctCount = 0;
                let totalCount = 0;

                groupItems.forEach(item => {
                    totalCount++;
                    const isCorrect = currentTestData[groupName].includes(item.textContent);

                    if (isCorrect) {
                        item.classList.add('correct');
                        correctCount++;
                    } else {
                        item.classList.add('incorrect');
                    }
                });

                resultHtml += `<p><strong>${groupName}åˆ†ç»„ï¼š</strong>æ­£ç¡® ${correctCount}/${currentTestData[groupName].length}</p>`;
            });

            result.innerHTML = resultHtml;

            // æ ¹æ®æ˜¯å¦æœ‰é‡å¤æ¡ç›®å†³å®šæ˜¯å¦æ˜¾ç¤º"å†æ¥ä¸€é"æŒ‰é’®
            if (hasDuplicateItems) {
                // æœ‰é‡å¤æ¡ç›®ï¼šåªè¦ç‚¹å‡»æ£€æŸ¥ç­”æ¡ˆå°±æ˜¾ç¤º"å†æ¥ä¸€é"æŒ‰é’®
                document.getElementById("restartBtn").style.display = "inline-block";
            } else {
                // æ— é‡å¤æ¡ç›®ï¼šæ£€æŸ¥itemPoolæ˜¯å¦ä¸ºç©º
                const itemPool = document.getElementById('itemPool');
                if (itemPool && itemPool.children.length === 0) {
                    document.getElementById("restartBtn").style.display = "inline-block";
                } else {
                    document.getElementById("restartBtn").style.display = "none";
                }
            }
        }

        // å†æ¥ä¸€éæŒ‰é’®äº‹ä»¶
        document.getElementById("restartBtn").addEventListener("click", function () {
            // é‡æ–°æ¸²æŸ“æ¡ç›®
            if (hasDuplicateItems) {
                const uniqueItems = ['1', '2', '3', '4'];
                renderItems(uniqueItems);
            } else {
                const allItems = ['1', '2', '3', '4', '5', '6'];
                renderItems(allItems);
            }

            // æ¸…ç©ºæ‰€æœ‰åˆ†ç»„
            document.querySelectorAll('.dropzone').forEach(dropzone => {
                dropzone.innerHTML = dropzone.querySelector('strong').outerHTML;
            });

            // éšè—"å†æ¥ä¸€é"æŒ‰é’®
            document.getElementById("restartBtn").style.display = "none";

            // æ¸…ç©ºç»“æœ
            document.getElementById("result").innerHTML = '';

            alert('å·²é‡æ–°å¼€å§‹ï¼');
        });
    </script>
</body>

</html>